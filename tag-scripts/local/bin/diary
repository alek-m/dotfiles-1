#!/bin/sh
#
# pbrisbin 2014 - keeping a code journal
#
# http://diary.pbrisbin.com
#
###
author() {
  local file="$1"

  ${VISUAL:-vim} "$file" && [ -s "$file" ]
}

publish() {
  local file="$1" timestamp="$(date +%Y%m%d-%H%M)"

  printf "%s -> entry:%s\n" "$file" "$timestamp"
  scp "$file" "pbrisbin.com:/srv/http/diary/$timestamp"
}

file="$(mktemp --suffix='.md')"

chmod 0644 "$file" && author "$file" && publish "$file" && rm "$file"

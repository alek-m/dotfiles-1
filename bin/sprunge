#!/usr/bin/env bash
#
# pbrisbin 2013 - paste stdin or the argument given to sprunge.us.
#
###
if (( ! $# )); then
  # simple, stdin usage
  read -r link < <(curl -# -F 'sprunge=<-' http://sprunge.us)
else
  read -r link < <(curl -# -F 'sprunge=<-' http://sprunge.us < "$1")

  ext="${1##*.}" # no-op if no extension
  [[ "$ext" != "$1" ]] && link="$link?$ext"
fi

[[ -n "$DISPLAY" ]] && echo -n "$link" | xclip
echo "$link"

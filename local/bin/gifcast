#!/usr/bin/env sh
#
# pbrisbin 2013 - record screen area as a gif. Requires ffcast (for
# xrectsel) and byzanz (for the actual recording).
#
###
set -e

tmp=temp.gif
out="${1:-out.gif}"
geometry_args="$(xrectsel "--x=%x --y=%y --width=%w --height=%h")"

[ -e "$out" ] && { printf "%s exists\n" "$out" >&2; exit 1; }

trap "convert -loop 0 '$tmp' '$out' && rm '$tmp'" EXIT

printf "Recording %s. Press ^C when done.\n" ./"$out"
byzanz-record -d 3600 $geometry_args "$tmp" # word-splitting intended

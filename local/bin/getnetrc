#!/usr/bin/env python
#
# pbrisbin 2013 - interface to netrc, specifically for email accounts.
#
###
import netrc
import sys

def get_password(email_address):
    try:
        net_rc = netrc.netrc()
    except IOError:
        return None

    if net_rc:
        for host in net_rc.hosts.keys():
            if host == email_address.split('@', 2)[1]:
                if net_rc.authenticators(host)[0] == email_address:
                    return net_rc.authenticators(host)[2]

    return None

if __name__ == '__main__':
    pw = get_password(sys.argv[1])

    if pw: print(pw)
